close all;
clear;
sigma_rayl=[0.0001;%1
%     0.0002;%
%     0.00025;%
    0.0003;%
%     0.00035;%
%     0.0004;%
%     0.00045;%
    0.0005;%
%     0.00055;%
%     0.0006;%
%     0.00065;%
    0.0007;%
%     0.00075;
%     0.0008;%
%     0.00085;%
%     0.0009;%
%     0.00095;%
    0.001;%
%     0.00105;%
%     0.0011;%
%     0.00115;
%     0.0012;%
%     0.00125;%
%     0.0013;%
%     0.0014;%
    0.0015;%
%     0.0016;%
%     0.0017;%
%     0.0018;%
%     0.0019;%
    0.002;%
%     0.0025;%
    0.003;%
%     0.0035;%
    0.004;%
%     0.0045;
%     0.005;%
%     0.0055;%
    0.006;%
%     0.0065;%
%     0.007;
%     0.0075;
    0.008;%
%     0.009;%
    0.010;
    0.015;
    0.02;
    0.03;
    0.04;
    0.05;
    0.06;
    0.07;
    0.08;%
    0.09;
    0.1;%
    0.15;
    0.20;
    0.4;
    0.6;
    1;
    ];
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
y_rayl_kmeans=[0;%1 0.0001
%     0.0025;%0.0002:0.00275
%     0.0045;%0.00025:0.005
    0.01125;%0.0003:0.011
%     0.01805;%0.00035
%     0.02425;%0.0004
%     0.031;%0.00045:0.03
    0.03775;%0.0005:0.3325
%     0.045;%0.00055:0.08
%     0.0525;%0.0006
%     0.0595;%0.00065:0.0615
    0.0665;%0.0007:0.07825
%     0.07475;%0.00075
%     0.08875;%0.0008:0.101 0.10025
%     0.10175;%0.00085:0.17275 0.186 0.09325
%     0.1115;%0.0009:0.162 0.1405 0.14775
%     0.12575;%0.00095
    0.13735;% 0.001 0.1385 0.13325
%     0.15075;%0.00105
%     0.1615;%0.0011
%     0.175;%0.00115
%     0.188575;%0.0012
%     0.2015;%0.00125:0.18275
%     0.21375;%0.0013:0.22225
%     0.2385;%0.0014
    0.25125;%0.0015:0.26125 0.2435
%     0.2635;%0.0016
%     0.27625;%0.0017
%     0.28475;%0.0018
%     0.2915;%0.0019
    0.30225;%0.002
%     0.3255;%0.0025
    0.34525;%0.003
%     0.359;%0.0035:0.374
    0.36825;%0.004
%     0.37525;%0.0045
%     0.382;%0.005
%     0.38675;%0.0055:0.4575
    0.3915;%0.006
%     0.3955;%0.0065
%     0.39875;%0.007 0.40075 
%     0.4005;%0.0075:0.3775
    0.4015;%0.008
%     0.4035;%0.009
    0.4055;%0.010
    0.41;%0.015
    0.4132;%0.02
    0.416;%0.03
    0.417;%0.04
    0.418;%0.05
    0.419;%0.06
    0.420;%0.07
    0.421;%0.08
    0.4219;%0.09
    0.4223;%0.1
    0.424;%0.15
    0.426;%0.02
    0.4295;%0.4
    0.43;%
    0.43;%1
    ];%1 rayl
y_rayl_ng=[0;%1 0.0001
%     0.0025;%0.0002:0.00275
%     0.0045;%0.00025:0.005
    0.01055;%0.0003:
%     0.0175;%0.00035
%     0.02375;%0.0004
%     0.03;%0.00045:0.06825
    0.03625;%0.0005:0.0315
%     0.04295;%0.00055:0.041 0.07125
%     0.04975;%0.0006
%     0.0565;%0.00065:0.1525 0.05875 0.06525
    0.06375;%0.0007:0.081 0.0645 0.06275 0.06975
%     0.07075;%0.00075
%     0.08275;%0.0008:0.09 0.0955 0.093
%     0.09305;%0.00085:0.22425 0.0945
%     0.10325;%0.0009:0.11575 0.10575
%     0.11075;%0.00095 0.101
    0.11825;% 0.001 0.24175 0.136
%     0.12575;%0.00105:0.12075
%     0.13725;%0.0011
%     0.1435;%0.00115
%     0.1565;%0.0012:0.18575
%     0.16675;%0.00125:0.19975
%     0.17675;%0.0013:0.215
%     0.194;%0.0014
    0.2105;%0.0015:0.264
%     0.225;%0.0016
%     0.23575;%0.0017
%     0.245;%0.0018
%     0.254;%0.0019
    0.265;%0.002
%     0.3055;%0.0025
    0.339;%0.003
%     0.35225;%0.0035:0.34925 0.35025
    0.36225;%0.004
%     0.3695;%0.0045
%     0.3755;%0.005
%     0.380575;%0.0055:0.4505 0.45575
    0.38525;%0.006
%     0.38975;%0.0065
%     0.39225;%0.007:0.3925 0.3895
%     0.39475;%0.0075
    0.3965;%0.008
%     0.399;%0.009
    0.40;%0.010
    0.4055;%0.015
    0.40915;%0.02
    0.41175;%0.03
    0.4135;%0.04
    0.4145;%0.05
    0.4155;%0.06
    0.4163;%0.07
    0.4175;%0.08
    0.41835;%0.09
    0.419;% 0.1 
    0.42275%0.15
    0.4255;%0.02
    0.4295;
    0.43;%0.
    0.43;%1
    ];%1 rayl
y_rayl_my=[0;%1 0.0001
%     0.0025;%0.0002:0.00275
%     0.0045;%0.00025:0.0045
    0.00995;%0.0003
%     0.017;%0.00035
%     0.02275;%0.0004
%     0.02875;%0.00045:0.031
    0.03515;%0.0005:0.0335
%     0.04105;%0.00055:0.03925
%     0.047;%0.0006
%     0.0538;%0.00065:0.063 0.06025
    0.06025;%0.0007:0.08075 0.05825
%     0.06725;%0.00075:0.07075
%     0.07575;%0.0008:0.09425 0.09475 0.0905 0.0855
%     0.08325;%0.00085:0.010675 0.094 0.10875 0.0835
%     0.09025;%0.0009:0.12 0.00975 0.0965
%     0.095;%0.00095:0.11725 
    0.10125;% 0.001 0.20125 0.133 0.10375
%     0.107;%0.0105
%     0.11175;%0.0011 0.13275 0.12175
%     0.11775;%0.00115
%     0.1235;%0.0012:0.12725
%     0.13125;%0.00125:0.1375
%     0.13875;%0.0013:0.15
%     0.1515;%0.0014
    0.16525;%0.0015:0.172 0.15825 0.1725
%     0.18075;%0.0016
%     0.19525;%0.0017
%     0.20525;%0.0018
%     0.215;%0.0019
    0.227;%0.002
%     0.283;%0.0025
    0.306;%0.003
%     0.345;%0.0035:0.38525
    0.34575;%0.004
%     0.36225;%0.0045
%     0.36925;%0.005:
%     0.3765;%0.0055
    0.3805;%0.006
%     0.3855;%0.0065
%     0.3885;%0.007:0.4185 0.368
%     0.3905;%0.0075
    0.39175;%0.008
%     0.393515;%0.009
    0.396125;%0.010
    0.4035%0.015
    0.40725;%0.02
    0.41075;%0.03
    0.4125;%0.04
    0.4135;%0.05
    0.41475;%0.06
    0.4155;%0.07
    0.41675;%0.08
    0.4175;%0.09
    0.41825;% 0.1:0.4
    0.422;%0.15
    0.4250;%0.02
    0.4295;%
    0.43;%0.03
    0.43;%1
    ];%1 rayl
figure;
grid on;
hold on;
rayl1=plot(sigma_rayl(1:end-5),y_rayl_kmeans(1:end-5),'y-p');
rayl2=plot(sigma_rayl(1:end-5),y_rayl_ng(1:end-5),'m-s');
rayl3=plot(sigma_rayl(1:end-5),y_rayl_my(1:end-5),'g-d');
% legend([rayl1,rayl2,rayl3],'kmeans','Ng','Me');
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
sigma_norm=[0.0001;%1
    0.001;%2
    0.01;%3
    0.015;%4
    0.02;
    0.025;
    0.03;
    0.035;
    0.04;%
    0.045;
    0.05;
    0.055;
    0.06;
    0.065;
    0.07;
    0.075;
    0.08;
    0.085;
    0.09;
    0.095;
    0.1;
    ];
y_norm_kmeans=[0.0001;%1 0.0001
    0.0001;% 0.001
    0.0005;%0.01
    0.002;%0.015
    0.0155;%0.02
    0.0565;%0.025:0.064
    0.1;%0.03
    0.14925;%0.035:0.23
    0.2235;%0.04:0.32275
    0.31;%0.045
    0.34875;%0.05:0.3585
    0.375;%0.055
    0.39;%0.06
    0.40;%0.065
    0.403;%0.07
    0.405;%0.075
    0.406;%0.08
    0.407;%0.085
    0.408;%0.09
    0.410;%0.095
    0.413% 0.1
    ];
y_norm_ng=[0.0001;%1 0.0001
    0.0001;% 0.001
    0.0005;%0.01
    0.002;%0.015
    0.01525;%0.02
    0.0515;%0.025:
    0.095;%0.03:0.17875
    0.141;%0.035:0.28725 0.141
    0.20575;%0.04:0.2835
    0.26775;%0.045
    0.321;%0.05:0.3075
    0.35;%0.055:0.44 0.40825
    0.37;%0.06
    0.385;%0.065
    0.39;%0.07
    0.395;%0.075
    0.402;%0.08
    0.406;%0.085
    0.4075;%0.09
    0.40975;%0.095
    0.413% 0.1
    ];
y_norm_my=[0.0001;%1 0.0001
    0.0001;% 0.001
    0.0005;%0.01
    0.002;%0.015
    0.0145;%0.02
    0.0465;%0.025
    0.09;%0.03:0.0875
    0.13;%0.035:0.143
    0.18225;%0.04:0.22125
    0.234;%0.045
    0.2945;%0.05
    0.33;%0.055:0.4835
    0.35;%0.06
    0.37;%0.065
    0.38;%0.07
    0.39;%0.075
    0.40;%0.08
    0.404;%0.85
    0.407;%0.09
    0.4095%0.095
    0.413%0.1
    ];
norm1=plot(sigma_norm(1:end),y_norm_kmeans(1:end),'y-p');
norm2=plot(sigma_norm(1:end),y_norm_ng(1:end),'m-s');
norm3=plot(sigma_norm(1:end),y_norm_my(1:end),'g-d');
legend([norm1,norm2,norm3],...
    'norm kmeans','norm Ng','norm Me');
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
sigma_exp=[0.0001;%1
    0.001;%2
    0.01;%3
    0.015;%4
    0.02;
    0.025;
    0.03;
    0.035;
    0.04;%
    %0.045;
    0.05;
    0.1;
    ];
y_exp_kmeans=[0;%1 exp
    0;% 0.001
    0;%0.01
    0;%0.015
    0;%0.02
    0.0005;%0.025:0.001
    0.0365;%0.03:0.14875 0.06
    0.076;%0.035:0.059 0.13
    0.15125;%0.04 0.1995
    0.35725;%0.05:0.344
    0.4% 0.1
    ];
y_exp_ng=[0;%1 exp
    0;% 0.001
    0;%0.01
    0;%0.015
    0;%0.02
    0.0005;%0.025:0.001
    0.031;%0.03:0.036
    0.097;%0.035:0.097 0.18775 0.2125
    0.085;%0.04:0.085 0.147
    0.34575;%0.05:0.34575
    0.4% 0.1
    ];
y_exp_my=[0;%1 exp
    0;% 0.001
    0;%0.01
    0;%0.015
    0;%0.02
    0.0005;%0.025:0.001
    0.061;%0.03:0.164 0.03
    0.095;%0.035:0.2675
    0.14075;%0.04 0.14075
    0.332;%0.05:0.332
    0.4%0.1
    ];
% exp1=plot(sigma_exp(1:end),y_exp_kmeans(1:end),'-x');
% exp2=plot(sigma_exp(1:end),y_exp_ng(1:end),'-s');
% exp3=plot(sigma_exp(1:end),y_exp_my(1:end),'-d');
% legend([exp1,exp2,exp3],...
%     'exp kmeans','exp Ng','exp Me');
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
sigma_chi2=[0.0001;%1
    0.001;%2
    0.01;%3
    0.015;%4
    0.02;
    0.025;
    0.03;
    0.035;
    0.04;%
    0.045;
%     0.046;
%     0.048;
    0.05;
    0.055;
    0.06;
    0.065;
    0.07;
    0.075;
    0.08;
    0.085;%
    0.09;
    0.095;
    0.1;
    ];
y_chi2_kmeans=[0;% 1 chi2
    0;% 0.001
    0.0001;%0.01
    0.0002;%0.015
    0.0005;%0.02
    0.001625;%0.025
    0.00555;%0.03
    0.013;%0.035:0.003
    0.027;%0.04
    0.052;%0.045
%     0.05425;%0.046
%     0.0640;%0.048
    0.0765;%0.05%0.24125
    0.112;%0.055
    0.14625;%0.06
    0.18225;%0.065
    0.21775;%0.07
    0.253;%0.075
    0.2905;%0.08
    0.32425;%0.085
    0.36175;%0.09
    0.394;%0.095
    0.41125%0.1
    ];%1 chi2
y_chi2_ng=[0;%1 chi2
    0;%0.001
    0.0001;%0.01
    0.0002;%0.015
    0.0005;%0.02
    0.001624;%0.025
    0.0054;%0.03:0.00125
    0.0125;%0.035:0.003
    0.02675;%0.04
    0.0495;%0.045
%     0.05325;%0.046
%     0.0625;%0.048
    0.07405;%0.05::0.215
    0.105;%0.055
    0.134;%0.06
    0.165;%0.065
    0.20125;%0.07
    0.238;%0.075
    0.27925;%0.08
    0.31775;%0.085
    0.3575;%0.09
    0.39175;%0.095
    0.41075%0.1
    ];%1 chi2
y_chi2_my=[0;%1 chi2
    0;%0.001
    0.0001;%0.01
    0.0002;%0.015
    0.0005;%0.02:
    0.001623;%0.025
    0.0052;%0.03:
    0.012;%0.035:0.1705
    0.026;%0.04
    0.0475;%0.045
%     0.05225;%0.046
%     0.0605;%0.048
    0.07275;%0.05:0.2585 0.21375******************************************************
    0.0995;%0.055
    0.126;%0.06
    0.155;%0.065
    0.19125;%0.07
    0.22825;%0.075
    0.27075;%0.08
    0.31325;%0.085
    0.35375;%0.09
    0.390;%0.095
    0.41015%0.1
    ];%1 chi2
chi21=plot(sigma_chi2(1:end),y_chi2_kmeans(1:end),'y-p');
chi22=plot(sigma_chi2(1:end),y_chi2_ng(1:end),'m-s');
chi23=plot(sigma_chi2(1:end),y_chi2_my(1:end),'g-d');
% legend([chi21,chi22,chi23],'chi2 kmeans','chi2 Ng','chi2 me');
% norm1=plot(sigma_norm(1:end),y_norm_kmeans(1:end),'y-p');
% norm2=plot(sigma_norm(1:end),y_norm_ng(1:end),'m-s');
% norm3=plot(sigma_norm(1:end),y_norm_my(1:end),'c-d');
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
sigma_geo=[0.0001;%1
    0.001;%2
    0.01;%3
    0.015;%4
    0.02;
    0.025;
    0.03;
    0.035;
    0.04;%
    %0.045;
    0.05;
    0.1;
    ];
y_geo_kmeans=[0;%1 0.0001
    0;%0.001
    0;%0.01
    0;%0.015
    0;%0.02
    0.001;%0.025
    0.0365;%0.03 0.0365
    0.07325;%0.035:0.05925
    0.335;%0.05
    0.367;%0.05:0.317
    0.4%0.1
    ];%1 geo
y_geo_ng=[0;%1 0.0001
    0;%0.001
    0;%0.01
    0;%0.015
    0;%0.02
    0.001;%0.025
    0.0365;%0.03 0.036
    0.0695;%0.035:0.0725
    0.23825;%0.04
    0.34725;%0.05:0.41625
    0.4%0.1
    ];%1 geo
y_geo_my=[0;
    0;%0.001
    0;%0.01
    0;%0.015
    0;%0.02
    0.001;%0.025
    0.036;%0.03:0.03575 0.0385
    0.05925;%0.035:0.05975
    0.207;%0.04
    0.334;%0.05:0.36875 
    0.4%0.1
    ];%1 geo
% geo1=plot(sigma_geo(1:end),y_geo_kmeans(1:end),'->');
% geo2=plot(sigma_geo(1:end),y_geo_ng(1:end),'-p');
% geo3=plot(sigma_geo(1:end),y_geo_my(1:end),'-h');

% chi21=plot(sigma(1:end),y_chi2_kmeans(1:end),'-^');
% chi22=plot(sigma(1:end),y_chi2_ng(1:end),'-v');
% chi23=plot(sigma(1:end),y_chi2_my(1:end),'-<');
% geo1=plot(sigma_geo(1:end),y_geo_kmeans(1:end),'->');
% geo2=plot(sigma_geo(1:end),y_geo_ng(1:end),'-p');
% geo3=plot(sigma_geo(1:end),y_geo_my(1:end),'-h');
% legend([norm1,norm2,norm3,...
%     %exp1,exp2,exp3,...
%     chi21,chi22,chi23,...
%     %geo1,geo2,geo3,...
%     rayl1,rayl2,rayl3...
%     ],...
%     'norm kmeans','norm Ng','norm Me',...
%     %'exp kmeans','exp Ng','exp me',
%     'chi2 kmeans','chi2 Ng','chi2 me',...
%     %'geo kmeans','geo Ng','geo me',...
%     'rayl kmeans','rayl Ng','rayl me');
% legend([norm1,norm2,norm3,...
%     chi21,chi22,chi23,...
%     rayl1,rayl2,rayl3...
%     ],...
%     'norm kmeans','norm Ng','norm Me',...
%     'chi2 kmeans','chi2 Ng','chi2 me',...
%     'rayl kmeans','rayl Ng','rayl me');
legend([norm1,norm2,norm3,...
    ],...
    'k-means','Ng','BIDSC');
t1=text(0.004,0.27,'$\leftarrow R\left(\sigma\right)$','FontSize',12);
t2=text(0.011,0.13,'$N\left(\mu,\sigma^2\right)\rightarrow$','FontSize',12);
t3=text(0.075,0.21,'$\leftarrow\left. G\left(\alpha,\beta\right)\right|_{\beta=2}$','FontSize',12);
set(t1,'Interpreter','latex');
set(t2,'Interpreter','latex');
set(t3,'Interpreter','latex');
xl=xlabel('$\sigma_f$');
yl=ylabel('$\mathrm{BER}$');
set(xl,'Interpreter','latex');
set(yl,'Interpreter','latex');
plot(0:0.001:0.1,0.05,'r.');
% set(gca,'yscale','log');%将Y轴刻度设为对数